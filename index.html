<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>Dice Solver Pro - Final Solution</title>
    <style>
        :root {
            --bg: #121212;
            --card: #1e1e1e;
            --accent: #ff4757;
            --dice-white: #ffffff;
        }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: white; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .container { background: var(--card); padding: 2.5rem; border-radius: 24px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); width: 100%; max-width: 500px; text-align: center; border: 1px solid #333; }
        
        .header h1 { margin: 0 0 1rem 0; font-size: 1.8rem; color: var(--accent); }
        .n-picker { margin-bottom: 1rem; color: #aaa; }
        select { background: #333; color: white; border: 1px solid #555; padding: 8px; border-radius: 8px; cursor: pointer; }

        /* éª°å­å®¹å™¨ */
        #input-area { 
            display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; 
            margin: 1.5rem 0; padding: 20px; min-height: 80px;
            border: 2px dashed #444; border-radius: 15px; background: rgba(255,255,255,0.02);
        }
        
        /* éª°å­æœ¬äººï¼šä¿è­‰çœ‹å¾—è¦‹ */
        .dice-input {
            width: 55px; height: 55px; 
            background-color: white !important; 
            color: black !important;
            border-radius: 12px; font-size: 1.6rem; font-weight: bold; 
            text-align: center; border: 2px solid #fff;
            box-shadow: 4px 4px 10px rgba(0,0,0,0.5); outline: none;
        }

        #target { 
            background: transparent; border: none; border-bottom: 3px solid var(--accent); 
            color: var(--accent); font-size: 2.5rem; width: 100px; text-align: center; 
            font-weight: bold; outline: none;
        }

        .btn-solve {
            margin-top: 2rem; background: var(--accent); color: white; border: none; 
            padding: 15px 50px; font-size: 1.2rem; font-weight: bold; border-radius: 50px; 
            cursor: pointer; transition: 0.3s; width: 100%;
        }
        .btn-solve:active { transform: scale(0.98); }

        .refresh-link { color: #555; font-size: 0.8rem; cursor: pointer; text-decoration: underline; margin-top: 5px; display: block; }

        #result { 
            margin-top: 2rem; padding: 1.5rem; border-radius: 15px; background: #252525;
            min-height: 80px; font-size: 1.4rem; color: #2ed573; display: flex; 
            flex-direction: column; align-items: center; justify-content: center;
        }
        .original-expr { font-size: 0.75rem; color: #666; margin-bottom: 8px; font-family: monospace; }
    </style>
</head>
<body>

<div class="container">
    <div class="header"><h1>ğŸ² Dice Solver Pro</h1></div>

    <div class="n-picker">
        æ•¸é‡ n = 
        <select id="n-select" onchange="generateInputs()">
            <option value="3">3</option><option value="4">4</option>
            <option value="5" selected>5</option><option value="6">6</option>
            <option value="7">7</option><option value="8">8</option>
        </select>
    </div>

    <div id="input-area"></div>
    <span class="refresh-link" onclick="generateInputs()">éª°å­æ²’å‡ºç¾ï¼Ÿé»æˆ‘å¼·åˆ¶æ•´ç†</span>

    <div class="target-section">
        <p style="color:#888; margin: 10px 0 0 0;">TARGET X</p>
        <input type="number" id="target" value="24">
    </div>

    <button class="btn-solve" onclick="crack()">SOLVE NOW</button>

    <div id="result">è¼¸å…¥æ•¸å­—å¾Œé»æ“ŠæŒ‰éˆ•</div>
</div>

<script>
    // 1. å¼·åˆ¶ç”Ÿæˆå‡½æ•¸
    function generateInputs() {
        const n = document.getElementById('n-select').value;
        const area = document.getElementById('input-area');
        console.log("Generating " + n + " dices..."); // é™¤éŒ¯ç”¨
        area.innerHTML = ''; 
        for (let i = 0; i < n; i++) {
            const input = document.createElement('input');
            input.type = 'number';
            input.className = 'dice-input';
            input.value = Math.floor(Math.random() * 6) + 1;
            area.appendChild(input);
        }
    }

    // 2. æ ¸å¿ƒé‚è¼¯
    function solveLogic(items, target) {
        if (items.length === 1) return Math.abs(items[0].val - target) < 0.0001 ? items[0].expr : null;
        for (let i = 0; i < items.length; i++) {
            for (let j = 0; j < items.length; j++) {
                if (i === j) continue;
                const a = items[i], b = items[j], rem = items.filter((_, idx) => idx !== i && idx !== j);
                const ops = [{o:'+',v:a.val+b.val},{o:'-',v:a.val-b.val},{o:'*',v:a.val*b.val},{o:'/',v:b.val!==0?a.val/b.val:null}];
                for (let o of ops) {
                    if (o.v === null) continue;
                    const res = solveLogic([...rem, {val:o.v, expr:`(${a.expr}${o.o}${b.expr})`}], target);
                    if (res) return res;
                }
            }
        }
        return null;
    }

    function crack() {
        const target = parseFloat(document.getElementById('target').value);
        const display = document.getElementById('result');
        const nums = [];
        document.querySelectorAll('.dice-input').forEach(el => {
            nums.push({ val: parseFloat(el.value), expr: el.value.toString() });
        });
        display.innerHTML = 'è¨ˆç®—ä¸­...';
        setTimeout(() => {
            const raw = solveLogic(nums, target);
            if (raw) {
                const clean = raw.replace(/\*/g,'Ã—').replace(/\//g,'Ã·');
                display.innerHTML = `<div class="original-expr">è·¯å¾‘: ${raw}</div><div>${clean} = ${target}</div>`;
            } else { display.innerHTML = 'æ­¤çµ„åˆç„¡è§£'; }
        }, 50);
    }

    // 3. ç¢ºä¿ä¸€é€²ä¾†å°±è·‘
    generateInputs();
    // é¡å¤–ä¿éšªï¼šå¦‚æœç¶²é è¼‰å…¥æ…¢ï¼ŒéåŠç§’å†è·‘ä¸€æ¬¡
    setTimeout(generateInputs, 500);
</script>
</body>
</html>
